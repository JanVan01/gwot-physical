{% extends "base/frontend.html" %}

{% block resources %}
<!-- Load c3.css -->
<link href="//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.css" rel="stylesheet" type="text/css">

<!-- Load d3.js and c3.js -->
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='datahandling.js') }}"></script>
{% endblock resources %}

{% block navigation %}"data"{% endblock navigation %}

{% block content %}
<h1>Geospatial Web of Things: Physical Smart Device Overview</h1>
<div id="chart4"></div>
<div id="chart5"></div>
<div id="chart6"></div>


<script>
    {% set comma = joiner(",") %}

    var distance = ['distance',{% for item in data %}{{comma()}}{{item.get_value() | round(2)}}{% endfor %}];

    var quality = ['quality',{% for item in data %}{{item.get_quality()}}{{comma()}}{% endfor %}];

    var time = ['x' {% for item in data %} {{comma()}}'{{item.get_datetime().replace(microsecond=0)}}' {% endfor %}];


    var maximals = maxim(distance, quality);
    var minimals = min(distance, quality);
    var uncertaintyAreas = uncertainty(time, quality);
    var chart = c3.generate({
        bindto: '#chart4',
        data: {
            x: 'x',
            //        xFormat: '%Y%m%d', // 'xFormat' can be used as custom format of 'x'
            columns: [
                //            ['x', '2013-01-01', '2013-01-02', '2013-01-03', '2013-01-04', '2013-01-05', '2013-01-06'],
                //            ['x', '20130101', '20130102', '20130103', '20130104', '20130105', '20130106'],
                //            ['data1', 30, 200, 100, 400, 150, 250],
                //            ['data2', 130, 340, 200, 500, 250, 350]
                distance,
                time,
                maximals,
                minimals
            ]
        },
        zoom: {
            enabled: true
        },
        axis: {
            x: {
                type: 'timeseries',
                tick: {
                    format: '%Y-%m-%d %H-%M-%S'
                }
            }
        },
        regions: uncertaintyAreas
    });
</script>





<h2>Data which should be used in second diagram</h2> {{data}}

{% endblock content %}
